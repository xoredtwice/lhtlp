(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     31581,        690]
NotebookOptionsPosition[     31140,        674]
NotebookOutlinePosition[     31621,        692]
CellTagsIndexPosition[     31578,        689]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox["(*", "Subsection"], 
   StyleBox[" ", "Subsection"], 
   StyleBox[
    RowBox[{"Public", " ", "parameter", " ", "setup"}], "Subsection"], 
   StyleBox[" ", "Subsection"], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"setup", "[", 
      RowBox[{"T_", ",", " ", "range_", ",", " ", "sMax_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "p", ",", "q", ",", "g", ",", "h", ",", "N", ",", " ", "t1", ",", " ",
          "\[Phi]", ",", " ", "y", ",", "i", " ", ",", "lookupTable"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", " ", "=", " ", 
         RowBox[{"RandomPrime", "[", "range", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"q", " ", "=", " ", 
         RowBox[{"RandomPrime", "[", "range", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"N", " ", "=", " ", 
         RowBox[{"p", " ", "*", " ", "q"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"g", " ", "=", " ", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"2", ",", " ", 
            RowBox[{"N", " ", "-", " ", "2"}]}], "}"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Phi]", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", " ", "-", " ", "1"}], ")"}], " ", "*", " ", 
          RowBox[{"(", 
           RowBox[{"q", " ", "-", " ", "1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t1", " ", "=", " ", 
         RowBox[{"PowerMod", "[", " ", 
          RowBox[{"2", ",", "T", ",", " ", "\[Phi]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"h", " ", "=", " ", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"g", ",", " ", "t1", ",", " ", "N"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"y", " ", "=", " ", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"2", ",", " ", 
            RowBox[{"N", " ", "-", " ", "2"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lookupTable", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PowerMod", "[", 
            RowBox[{"y", ",", "i", ",", " ", "N"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", "sMax"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<N\>\"", "\[Rule]", "N"}], ",", 
            RowBox[{"\"\<g\>\"", "\[Rule]", "g"}], ",", 
            RowBox[{"\"\<h\>\"", "\[Rule]", "h"}], ",", 
            RowBox[{"\"\<y\>\"", "\[Rule]", "y"}], ",", " ", 
            RowBox[{"\"\<T\>\"", "->", " ", "T"}], ",", " ", 
            RowBox[{"\"\<sMax\>\"", "->", " ", "sMax"}]}], " ", "|>"}], ",", 
          " ", "lookupTable"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]", "Section"], 
   RowBox[{
    StyleBox["(*", "Subsection"], 
    StyleBox[" ", "Subsection"], 
    StyleBox[
     RowBox[{"Generate", " ", "TimeLock", " ", "Puzzle"}], "Subsection"], 
    StyleBox[" ", "Subsection"], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"generatePuzzle", "[", 
      RowBox[{"pp_", ",", "solution_", ",", " ", "r_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "g", ",", "N", ",", "c1", ",", " ", "c2", ",", " ", "h", ",", "y", 
         ",", " ", "hr"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", " ", "=", " ", 
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<g\>\"", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"h", " ", "=", " ", 
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<h\>\"", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"y", " ", "=", " ", 
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<y\>\"", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"N", " ", "=", " ", 
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<N\>\"", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"hr", " ", "=", " ", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"h", ",", "r", ",", "N"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c1", "=", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"g", ",", "r", ",", "N"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c2", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PowerMod", "[", 
             RowBox[{"y", ",", "solution", " ", ",", "N"}], "]"}], " ", "*", 
            " ", "hr"}], ",", "N"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(c\), \(1\)]\)\>\"", "\[Rule]", "c1"}], 
          ",", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(c\), \(2\)]\)\>\"", "\[Rule]", "c2"}]}], 
         "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    StyleBox["(*", "Subsection"], 
    StyleBox[
     RowBox[{"Solve", " ", "TimeLock", " ", "Puzzle"}], "Subsection"], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"solvePuzzle", "[", 
      RowBox[{"puzzle_", ",", " ", "pp_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "g", ",", " ", "ys", ",", " ", "hr", ",", " ", "y", ",", " ", "N", 
         ",", " ", "i", ",", "T", ",", " ", "c1", ",", " ", "c2"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Please wait...\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"g", " ", "=", " ", 
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<g\>\"", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"y", " ", "=", " ", 
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<y\>\"", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"N", " ", "=", " ", 
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<N\>\"", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"T", " ", "=", " ", 
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<T\>\"", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"c1", " ", "=", " ", 
         RowBox[{"puzzle", "[", 
          RowBox[{"[", "\"\<\!\(\*SubscriptBox[\(c\), \(1\)]\)\>\"", "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c2", " ", "=", " ", 
         RowBox[{"puzzle", "[", 
          RowBox[{"[", "\"\<\!\(\*SubscriptBox[\(c\), \(2\)]\)\>\"", "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"hr", " ", "=", " ", "c1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "0"}], ",", 
          RowBox[{"i", "<", "T"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"hr", "=", " ", 
            RowBox[{"PowerMod", "[", 
             RowBox[{"hr", ",", " ", "2", ",", " ", "N"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Mod", "[", " ", 
         RowBox[{
          RowBox[{"c2", " ", "*", " ", 
           RowBox[{"PowerMod", "[", 
            RowBox[{"hr", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "N"}], "]"}]}], ",", "N"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"addPuzzles", "[", 
      RowBox[{"pp_", ",", " ", "puzzle1_", ",", " ", "puzzle2_"}], "]"}], " ",
      ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"N", ",", " ", "c1", ",", " ", "c2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"N", " ", "=", " ", 
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<N\>\"", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c1", " ", "=", " ", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"puzzle1", "[", 
             RowBox[{"[", "\"\<\!\(\*SubscriptBox[\(c\), \(1\)]\)\>\"", "]"}],
              "]"}], " ", "*", " ", 
            RowBox[{"puzzle2", "[", 
             RowBox[{"[", "\"\<\!\(\*SubscriptBox[\(c\), \(1\)]\)\>\"", "]"}],
              "]"}]}], ",", "  ", "N"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c2", " ", "=", " ", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"puzzle1", "[", 
             RowBox[{"[", "\"\<\!\(\*SubscriptBox[\(c\), \(2\)]\)\>\"", "]"}],
              "]"}], " ", "*", " ", 
            RowBox[{"puzzle2", "[", 
             RowBox[{"[", "\"\<\!\(\*SubscriptBox[\(c\), \(2\)]\)\>\"", "]"}],
              "]"}]}], ",", " ", "N"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(c\), \(1\)]\)\>\"", "\[Rule]", "c1"}], 
          ",", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(c\), \(2\)]\)\>\"", "\[Rule]", "c2"}]}], 
         "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"TLP", " ", "Test"}], " ", "*)"}], "Subsection"], 
   StyleBox[" ", "Subsection"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "solution1", ",", " ", "solution2", ",", "puzzle1", ",", " ", "puzzle2", 
      ",", " ", "puzzle3", ",", " ", "qRange", ",", "sMax", ",", " ", "T", 
      ",", " ", "ans1", " ", ",", " ", "ans2", ",", " ", "ans3", ",", "pp", 
      ",", "r1", ",", " ", "r2", ",", " ", "ys1", ",", " ", "ys2", ",", " ", 
      "ys3", ",", " ", "lookupTable", ",", " ", "decSolution1", ",", " ", 
      "decSolution2", ",", " ", "decSolution3"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Puzzle", " ", "test", " ", "parameters"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"range", " ", "of", " ", "p"}], ",", 
     RowBox[{
      RowBox[{"q", " ", "to", " ", "construct", " ", "N"}], " ", "=", " ", 
      RowBox[{"p", ".", "q"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qRange", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["2", "20"], ",", " ", 
       SuperscriptBox["2", "21"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "maximum", " ", "value", " ", "of", " ", "solution", " ", "for", " ", 
      "look"}], "-", 
     RowBox[{"up", " ", "table", " ", "generation"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sMax", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"final", " ", "solution"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution1", " ", "=", " ", "12"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution2", " ", "=", " ", "15"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"number", " ", "of", " ", "rounds"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", " ", "=", " ", "1000"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"setup", " ", "public", " ", "paramters"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pp", ",", " ", "lookupTable"}], "}"}], "=", 
     RowBox[{"setup", "[", 
      RowBox[{"T", ",", " ", "qRange", ",", " ", "sMax"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Public Parameters = \>\"", ",", "pp"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ys1", " ", "=", " ", 
     RowBox[{"PowerMod", "[", 
      RowBox[{
       RowBox[{"pp", "[", 
        RowBox[{"[", "\"\<y\>\"", "]"}], "]"}], ",", " ", "solution1", ",", 
       " ", 
       RowBox[{"pp", "[", 
        RowBox[{"[", "\"\<N\>\"", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ys2", " ", "=", " ", 
     RowBox[{"PowerMod", "[", 
      RowBox[{
       RowBox[{"pp", "[", 
        RowBox[{"[", "\"\<y\>\"", "]"}], "]"}], ",", " ", "solution2", ",", 
       " ", 
       RowBox[{"pp", "[", 
        RowBox[{"[", "\"\<N\>\"", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ys3", " ", "=", " ", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"ys1", " ", "*", " ", "ys2"}], ",", " ", 
       RowBox[{"pp", "[", 
        RowBox[{"[", "\"\<N\>\"", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Printing", " ", "the", " ", "final", " ", "solution", " ", "to", " ", 
     "compare"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\!\(\*SuperscriptBox[\(y\), \(solution1\)]\) = \>\"", ",", " ", 
      "ys1"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\!\(\*SuperscriptBox[\(y\), \(solution2\)]\) = \>\"", ",", " ", 
      "ys2"}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generating", " ", "random", " ", "values", " ", "for", " ", "puzzles"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r1", "=", " ", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<N\>\"", "]"}], "]"}], "-", " ", "2"}]}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r2", "=", " ", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{
         RowBox[{"pp", "[", 
          RowBox[{"[", "\"\<N\>\"", "]"}], "]"}], "-", " ", "2"}]}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\\n\\nCreating Puzzle1 with solution1 = \>\"", ",", " ", 
      "solution1", ",", " ", "\"\< , r1 = \>\"", ",", " ", "r1"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"puzzle1", " ", "=", 
     RowBox[{"generatePuzzle", "[", 
      RowBox[{"pp", ",", " ", "solution1", ",", " ", "r1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Puzzle 1: \>\"", ",", " ", "puzzle1"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\\nCreating Puzzle2 with solution2 = \>\"", ",", " ", "solution2", 
      ",", " ", "\"\< , r2 = \>\"", ",", " ", "r2"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"puzzle2", " ", "=", 
     RowBox[{"generatePuzzle", "[", 
      RowBox[{"pp", ",", " ", "solution2", ",", " ", "r2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Puzzle 2: \>\"", ",", " ", "puzzle2"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\\n\\nSolving Puzzle1 = \>\"", ",", " ", "puzzle1"}], "]"}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"solving", " ", "the", " ", "TLP"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ans1", " ", "=", " ", 
     RowBox[{"solvePuzzle", "[", 
      RowBox[{"puzzle1", ",", " ", "pp"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<solved (\!\(\*SuperscriptBox[\(y\), \(solution1\)]\)): \>\"", ",", 
      " ", "ans1"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\\nSolving Puzzle2 = \>\"", ",", " ", "puzzle2"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ans2", " ", "=", " ", 
     RowBox[{"solvePuzzle", "[", 
      RowBox[{"puzzle2", ",", " ", "pp"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<solved(\!\(\*SuperscriptBox[\(y\), \(solution2\)]\)): \>\"", ",", 
      " ", "ans2"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\n\\nAdding two puzzles\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"puzzle3", " ", "=", " ", 
     RowBox[{"addPuzzles", "[", 
      RowBox[{"pp", ",", " ", "puzzle1", ",", " ", "puzzle2"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\\nSolving Puzzle3 = \>\"", ",", " ", "puzzle3"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ans3", " ", "=", " ", 
     RowBox[{"solvePuzzle", "[", 
      RowBox[{"puzzle3", ",", " ", "pp"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<solved (\!\(\*SuperscriptBox[\(y\), \(sum\)]\)): \>\"", ",", " ", 
      "ans3"}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\!\(\*SuperscriptBox[\(y\), \(solution1\)]\) * \
\!\(\*SuperscriptBox[\(y\), \(solution2\)]\) (\>\"", ",", "ys3", ",", 
      "\"\<) == \!\(\*SuperscriptBox[\(y\), \(sum\)]\) (\>\"", ",", "ans3", 
      ",", " ", "\"\<)\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Print", "[", 
     "\"\<\\n\\nUsing lookup table to decode \!\(\*SuperscriptBox[\(y\), \
\(solution\)]\)\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"decSolution1", " ", "=", " ", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"lookupTable", ",", " ", "ans1"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"decSolution2", " ", "=", " ", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"lookupTable", ",", " ", "ans2"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"decSolution3", " ", "=", " ", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"lookupTable", ",", " ", "ans3"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Decoded Solution 1 = \>\"", ",", " ", "decSolution1"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Decoded Solution 2 = \>\"", ",", "decSolution2"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Decoded Solution 3 = \>\"", ",", " ", "decSolution3"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<solution1 + solution2 (\>\"", ",", 
      RowBox[{"decSolution1", " ", "+", " ", "decSolution2"}], ",", 
      "\"\<) == solution3 (\>\"", ",", "decSolution3", ",", " ", 
      "\"\<)\>\""}], "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9381614466643744`*^9, 3.938161449288537*^9}, {
   3.938161841929352*^9, 3.93816192521373*^9}, {3.938162028875952*^9, 
   3.938162051020918*^9}, {3.938162244476985*^9, 3.9381622869405317`*^9}, {
   3.938163430804368*^9, 3.938163493700657*^9}, 3.9381635285802526`*^9, {
   3.938163681595798*^9, 3.938163713304942*^9}, {3.938163769661521*^9, 
   3.9381638505620127`*^9}, {3.938163944989513*^9, 3.9381639555360937`*^9}, {
   3.938164126096609*^9, 3.938164153767412*^9}, {3.93816477668954*^9, 
   3.938164777439814*^9}, {3.938164829174057*^9, 3.938164833217132*^9}, 
   3.9381648797610826`*^9, {3.938164977713828*^9, 3.938165208410235*^9}, {
   3.938165241213476*^9, 3.938165373708647*^9}, {3.938165435368615*^9, 
   3.9381654379113503`*^9}, {3.938165526567523*^9, 3.93816553975371*^9}, {
   3.938165574650877*^9, 3.938165582066036*^9}, {3.938166330570175*^9, 
   3.938166434785193*^9}, {3.938166700866441*^9, 3.938166713730616*^9}, {
   3.938166772428792*^9, 3.9381668707232313`*^9}, {3.9381681039290037`*^9, 
   3.9381681594798307`*^9}, {3.938168226181224*^9, 3.938168308136063*^9}, {
   3.938168400542201*^9, 3.938168433794845*^9}, {3.938169240917775*^9, 
   3.938169257079195*^9}, {3.938169292225491*^9, 3.93816939886281*^9}, {
   3.938169454261052*^9, 3.938169460267734*^9}, {3.93816949054038*^9, 
   3.938169579387969*^9}, 3.9381696589483347`*^9, {3.9381698073427277`*^9, 
   3.938169812482813*^9}, 3.938174589218704*^9, {3.938174678724286*^9, 
   3.938174732016621*^9}, {3.938179237002993*^9, 3.938179264812813*^9}, {
   3.9381795187019367`*^9, 3.938179521274652*^9}, {3.93817955860861*^9, 
   3.938179599227133*^9}, 3.9381796340308037`*^9, {3.9381797456249228`*^9, 
   3.93817975613982*^9}, {3.9381797872884398`*^9, 3.938179811393178*^9}, {
   3.938181297604721*^9, 3.938181341125128*^9}, {3.938181424223363*^9, 
   3.93818144300003*^9}, {3.938181487836948*^9, 3.938181492545721*^9}, {
   3.938181525486123*^9, 3.938181552284766*^9}, {3.938181625315147*^9, 
   3.9381817168723993`*^9}, {3.938181748625168*^9, 3.938181767106941*^9}, {
   3.938183058866029*^9, 3.93818307028269*^9}, {3.9381835101177273`*^9, 
   3.93818363897013*^9}, {3.938184344730317*^9, 3.9381843460342283`*^9}, {
   3.9381843788767157`*^9, 3.938184395856656*^9}, {3.9381845049990797`*^9, 
   3.938184621501068*^9}, {3.9381848268094177`*^9, 3.93818482976206*^9}, {
   3.938184937553979*^9, 3.938185008783272*^9}, {3.938185155842526*^9, 
   3.938185158022587*^9}, {3.9381852848398743`*^9, 3.938185287522316*^9}, {
   3.9381856208660316`*^9, 3.938185670520381*^9}, {3.938185715145371*^9, 
   3.938185856859248*^9}, {3.938185978356381*^9, 3.938186122291003*^9}, {
   3.938186313905191*^9, 3.938186360023192*^9}, {3.938186554945503*^9, 
   3.9381866476015577`*^9}, 3.93818679717157*^9, {3.938186925310717*^9, 
   3.93818697811592*^9}, {3.93818704759603*^9, 3.938187054367358*^9}, {
   3.938187092327745*^9, 3.938187097042528*^9}, {3.9381872085622473`*^9, 
   3.938187292419846*^9}, {3.9381873391954823`*^9, 3.938187428537757*^9}, {
   3.9381874777663717`*^9, 3.938187709927108*^9}, {3.938187788036607*^9, 
   3.938187807831218*^9}, {3.938187868804994*^9, 3.938187911786088*^9}, {
   3.938188020462675*^9, 3.938188061890583*^9}, {3.9381880927233953`*^9, 
   3.938188096953927*^9}, {3.938188237788726*^9, 3.938188244229129*^9}, 
   3.938189534807856*^9, {3.938189765553246*^9, 3.938189787728006*^9}, {
   3.9381898623360023`*^9, 3.93818986600712*^9}, {3.938190128924141*^9, 
   3.938190172586122*^9}, {3.9381905102807207`*^9, 3.9381905120502863`*^9}, {
   3.9381906510617437`*^9, 3.938190688404484*^9}, {3.938190769123959*^9, 
   3.938190916016595*^9}, {3.938190951525064*^9, 3.9381909576216383`*^9}, 
   3.93819125559783*^9, 3.9381913415201063`*^9, 3.938191527504237*^9, {
   3.938192050685997*^9, 3.93819210123477*^9}, 3.938192169435429*^9, {
   3.938192320280023*^9, 3.938192363638077*^9}, {3.938193010606126*^9, 
   3.93819304953153*^9}, {3.9381932512795057`*^9, 3.93819325338885*^9}, 
   3.9381936530661*^9, 3.938193873548338*^9, 3.938193945141428*^9, {
   3.938227360651403*^9, 3.938227372333807*^9}, {3.938608836869075*^9, 
   3.938608837074472*^9}, {3.938608973700906*^9, 3.938609009344657*^9}, {
   3.938609246221303*^9, 3.938609251325076*^9}, {3.9386093219424*^9, 
   3.9386093426309757`*^9}, {3.938609643757312*^9, 3.938609664872678*^9}, {
   3.9386097258808327`*^9, 3.938609727681148*^9}, {3.938609775898336*^9, 
   3.938609785224688*^9}, {3.938609853286087*^9, 3.938609853736401*^9}, {
   3.938609942334594*^9, 3.9386099758509502`*^9}, 3.938610014940222*^9, {
   3.938610142088172*^9, 3.938610166947009*^9}, {3.9386102515828037`*^9, 
   3.938610335638246*^9}, 3.9386103675969954`*^9, {3.9386106972830057`*^9, 
   3.938610724588614*^9}, 3.938611426374997*^9, {3.938611484376622*^9, 
   3.938611530995284*^9}, {3.938611672942934*^9, 3.9386117092546387`*^9}, 
   3.938612079631772*^9, {3.938612291257585*^9, 3.938612334336171*^9}, {
   3.93861244966362*^9, 3.938612475185987*^9}, {3.938615117779166*^9, 
   3.938615236443974*^9}, {3.938615270541966*^9, 3.938615294760462*^9}, {
   3.938615345842753*^9, 3.938615348177805*^9}, {3.9386153800898857`*^9, 
   3.938615505442378*^9}, {3.9386203493258457`*^9, 3.938620453579536*^9}, {
   3.938620735176873*^9, 3.938620748943329*^9}, {3.938620780587934*^9, 
   3.938620783494977*^9}, {3.9386218286231318`*^9, 3.938621858349018*^9}, {
   3.9386219310076313`*^9, 3.938621998609424*^9}, {3.938622246996914*^9, 
   3.938622252895341*^9}, {3.9386226212701073`*^9, 3.9386226229104433`*^9}, 
   3.938622671819436*^9, 3.938622950249794*^9, {3.9386240645443974`*^9, 
   3.9386240911810017`*^9}, {3.938624195176552*^9, 3.938624197592989*^9}, {
   3.938624267755617*^9, 3.938624268360179*^9}, {3.9386243552990017`*^9, 
   3.938624357997127*^9}, {3.9386245109765673`*^9, 3.9386245141833363`*^9}, {
   3.938624559732052*^9, 3.938624610379592*^9}, {3.938624647563849*^9, 
   3.9386247087230997`*^9}, {3.938624742200787*^9, 3.9386248145319557`*^9}, {
   3.938668784871731*^9, 3.938668785780353*^9}, {3.938669609516234*^9, 
   3.938669772589748*^9}, {3.938669820134153*^9, 3.938670115991764*^9}, {
   3.938670155686174*^9, 3.9386701992735653`*^9}, {3.938670254801855*^9, 
   3.938670279275107*^9}, {3.938670322531926*^9, 3.938670441024993*^9}, {
   3.9386704711179457`*^9, 3.938670497528068*^9}, {3.9386732908973*^9, 
   3.938673331915388*^9}, {3.938673394573371*^9, 3.938673526023643*^9}, {
   3.938673590315857*^9, 3.938673664710821*^9}, {3.938673716096841*^9, 
   3.938673718757866*^9}, {3.9386737703338127`*^9, 3.938673835409799*^9}, {
   3.938673894517474*^9, 3.93867395288262*^9}, {3.938674094160926*^9, 
   3.938674094453485*^9}, {3.9386741391546297`*^9, 3.938674238770701*^9}, {
   3.938674285308279*^9, 3.9386743820338306`*^9}, {3.9386744286565866`*^9, 
   3.9386746068739758`*^9}, {3.9386746541077747`*^9, 3.938674692925226*^9}, {
   3.9386748137942457`*^9, 3.938674978920987*^9}, {3.938675015093354*^9, 
   3.938675093635622*^9}, {3.9398171834690437`*^9, 3.9398172510767593`*^9}, {
   3.9398173954641943`*^9, 3.939817450400983*^9}, {3.93981749001439*^9, 
   3.939817536053157*^9}, {3.9398175750060263`*^9, 3.939817597970891*^9}, {
   3.93981763749515*^9, 3.9398177984723873`*^9}, {3.939817858054228*^9, 
   3.93981786270679*^9}, {3.939817911688506*^9, 3.9398179282468863`*^9}, {
   3.9398179755585537`*^9, 3.9398180305935907`*^9}, {3.9398181512434*^9, 
   3.939818155436071*^9}, {3.939818187192984*^9, 3.939818236572172*^9}, {
   3.939818278514381*^9, 3.9398184894054613`*^9}, {3.939818586115966*^9, 
   3.939818627560285*^9}, {3.93981866610709*^9, 3.939818733518672*^9}, {
   3.939818778424541*^9, 3.9398187897168627`*^9}, {3.939818850611249*^9, 
   3.939818896989917*^9}, {3.939818947000464*^9, 3.939819012307706*^9}, {
   3.939819146742446*^9, 3.939819191000855*^9}, {3.939834380228075*^9, 
   3.939834381094265*^9}, {3.939834503228868*^9, 3.93983450422055*^9}, {
   3.9410257920180264`*^9, 3.9410258199786987`*^9}, {3.9410258898377876`*^9, 
   3.941025948099512*^9}, {3.94102598400778*^9, 3.941026040468012*^9}, {
   3.9410261147624245`*^9, 3.941026150399666*^9}, {3.941026269779011*^9, 
   3.941026296654516*^9}, 3.94102650524082*^9, {3.941026553170225*^9, 
   3.941026610821802*^9}, {3.941027071686119*^9, 3.941027293790184*^9}, {
   3.9410273301218014`*^9, 3.941027335785591*^9}, {3.9411079760335236`*^9, 
   3.941107989833563*^9}, {3.9411081506640377`*^9, 3.941108152836035*^9}, {
   3.9411084367557545`*^9, 3.9411084417082253`*^9}, {3.9411087168975716`*^9, 
   3.941108724872286*^9}, {3.9411088047683353`*^9, 3.9411088078423767`*^9}, {
   3.941109087099701*^9, 3.941109115765337*^9}, {3.941109319694168*^9, 
   3.9411093324643135`*^9}, 3.9411093689343147`*^9, {3.941109440274639*^9, 
   3.9411094434425373`*^9}, {3.9411095501930485`*^9, 
   3.9411095729291058`*^9}, {3.941109612739502*^9, 3.9411097571638412`*^9}, {
   3.941109791617058*^9, 3.9411100513480835`*^9}, {3.94111008685445*^9, 
   3.941110427221985*^9}, {3.9411104784799366`*^9, 3.9411106379471436`*^9}, {
   3.941111221960121*^9, 3.941111225550234*^9}, {3.941111517147789*^9, 
   3.941111636485998*^9}, {3.9411116683908215`*^9, 3.941111726817745*^9}, {
   3.941111962520586*^9, 3.9411119679868946`*^9}, {3.9411120613505573`*^9, 
   3.9411120680511265`*^9}, {3.9411121253360577`*^9, 3.941112184821232*^9}, {
   3.9411123074591923`*^9, 3.94111232819623*^9}, {3.9411123603621063`*^9, 
   3.9411123613314514`*^9}, {3.941112392360691*^9, 3.941112395227333*^9}, {
   3.9411126100128136`*^9, 3.941112635998417*^9}, {3.9411126894201145`*^9, 
   3.9411126899943943`*^9}, {3.9411127826022415`*^9, 
   3.9411128876700993`*^9}, {3.941113001396658*^9, 3.9411130497625523`*^9}, {
   3.9411130997112026`*^9, 3.94111311029838*^9}, {3.9411131592792435`*^9, 
   3.9411131716953735`*^9}, {3.941113209995693*^9, 3.9411132132952385`*^9}, {
   3.941113315102844*^9, 3.9411133378887863`*^9}, {3.9411140477333107`*^9, 
   3.941114200121395*^9}, {3.9411142772452335`*^9, 3.941114319738369*^9}, {
   3.941114353239544*^9, 3.941114389705969*^9}, {3.941114451593994*^9, 
   3.9411145330646877`*^9}, {3.9411145790297985`*^9, 
   3.9411145886326313`*^9}, {3.9411146750494576`*^9, 
   3.9411147560944843`*^9}, {3.9411147882893543`*^9, 
   3.9411149265387897`*^9}, {3.9411149583718567`*^9, 
   3.9411149984809494`*^9}, {3.941115034144516*^9, 3.941115035972883*^9}, {
   3.9411151371290245`*^9, 3.941115156672735*^9}, {3.941115198992441*^9, 
   3.941115250048828*^9}, {3.9411152996857224`*^9, 3.941115318327528*^9}, {
   3.9411155658853207`*^9, 3.9411157792803364`*^9}, {3.941115817248268*^9, 
   3.941115911267561*^9}, {3.941115962847191*^9, 
   3.9411160218579235`*^9}},ExpressionUUID->"c050dc66-65d9-4385-8cc8-\
224443988fa3"]
},
WindowSize->{1080, 607.5},
WindowMargins->{{-4.875, Automatic}, {Automatic, -4.875}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.1 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fcf23024-0d6f-45cb-86e1-b625016affb8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 30582, 652, 2520, "Input",ExpressionUUID->"c050dc66-65d9-4385-8cc8-224443988fa3"]
}
]
*)

